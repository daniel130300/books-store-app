 <%= link_to books_path, class:"btn btn-link px-0 mb-4" do %>
  <%= fa_icon 'arrow-circle-left' %> Continue shopping
<% end %>

<h3 class="mb-4">Shopping Cart</h3>

<div class="row">
    <div class="col-9">
        <% if !@cart_books.blank? %>
        <table class="table table-striped">
            <thead>
                <tr>
                <th scope="col text-center">Book</th>
                <th scope="col text-center">Quantity</th>
                <th scope="col text-center">Price</th>
                <th scope="col text-center" colspan = "2">Actions</th>
                </tr>
            </thead>
            <tbody>
                <% @cart_books.each do |book| %>
                    <tr class="my-3">
                        <td> <%= current_user.cart_books.find(book[:book_id])[:title] %></td>
                        <td>
                            <%= form_with(model:@cart_checkout, url: update_cart_prices_path, local: true, method: :put) do |f| %>
                                <%= f.hidden_field :book_id, value: book[:book_id]%>
                                <%= f.number_field :quantity, value: book[:quantity], in: 1..30, class: "form-control", onchange: 'this.form.submit()'%>
                            <% end %>
                        </td>
                        <td><%= number_to_currency(book[:book_id]) %></td>
                        <td><%= link_to 'View', '#', class: 'btn btn-sm btn-primary' %></td>
                        <td><%= link_to 'Delete', '#', class: 'btn btn-sm btn-danger', method: :post %></td>
                    </tr>
                <% end %>
            </tbody>
        </table>
        <% else %>
            <% render 'shared/nothing_found' %>
        <% end  %>
    </div>

    <div class="col-3 bg-light">
        <div class="d-flex flex-column mt-4">
            <div id="cart_prices">
                <p><span class="font-weight-bold">Subtotal: </span><%= number_to_currency(@prices[:subtotal]) %></p>
                <p><span class="font-weight-bold">Taxes: </span><%= number_to_currency(@prices[:tax]) %></p>
                <p><span class="font-weight-bold">Total: </span><%= number_to_currency(@prices[:total]) %></p>
                <%= button_to 'Proceed to checkout', '#', class:"btn btn-success"%>
            </div>
        </div>
    </div>
</div>